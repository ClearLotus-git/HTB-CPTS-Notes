## Initial Setup

- [ ]  Confirm the scope of the pentest (e.g., specific domains, forests, or subnets to test)
- [ ]  Verify the rules of engagement (e.g., what is allowed or restricted, time constraints)
- [ ]  Set up the pentest environment (e.g., install tools like PowerView, BloodHound, Mimikatz on a VM or attack machine)
- [ ]  Ensure network connectivity to the target domain (e.g., join the domain or confirm VPN access)
- [ ]  If credentials are provided, document them securely (e.g., username, password, or hashes)
- [ ]  Determine the testing approach (e.g., black-box with no initial access, or white-box with provided credentials)

## Reconnaissance

### Unauthenticated Reconnaissance

- [ ]  Perform DNS enumeration to identify domain controllers (e.g., nslookup -type=SRV _ldap._tcp.dc._msdcs.<domain>)
- [ ]  Scan for open ports on potential domain controllers and servers using nmap (e.g., nmap -p 88,389,445,3389 <target>)
- [ ]  Check for anonymous LDAP bind (e.g., use ldapsearch to test if enumeration is possible without credentials)
- [ ]  Identify exposed services that might leak information (e.g., SMB, RPC, HTTP)

### Authenticated Reconnaissance (If Credentials Available)

- [ ]  Map the domain structure using BloodHound (e.g., run SharpHound.exe or BloodHound.py to collect data)
- [ ]  Enumerate domain users, groups, computers, and GPOs with PowerView (e.g., Get-NetDomain, Get-NetUser, Get-NetGroup)
- [ ]  Identify domain controllers (e.g., Get-NetDomainController in PowerView)
- [ ]  Discover trusts between domains or forests (e.g., Get-NetDomainTrust)
- [ ]  Document the forest layout (e.g., root domain, child domains)

## Enumeration

### User Enumeration

- [ ]  List all user accounts in the domain (e.g., Get-NetUser in PowerView or Get-ADUser in ActiveDirectory module)
- [ ]  Identify privileged users (e.g., domain admins, enterprise admins) by checking adminCount=1 or group membership
- [ ]  Find service accounts with SPNs set (e.g., Get-NetUser -SPN or Get-ADUser -Filter {ServicePrincipalName -ne "$null"})
- [ ]  Check user descriptions for sensitive information (e.g., passwords, notes) using Get-NetUser | Select-Object samAccountName, description)
- [ ]  Look for inactive or disabled accounts that might still have access (e.g., filter by lastLogonTimestamp)

### Group Enumeration

- [ ]  List all groups in the domain (e.g., Get-NetGroup)
- [ ]  Focus on administrative groups (e.g., Domain Admins, Enterprise Admins) with Get-NetGroup "Domain Admins"
- [ ]  Check group memberships, including nested groups (e.g., Get-NetGroupMember -Recurse)
- [ ]  Identify groups with excessive permissions on AD objects

### Computer Enumeration

- [ ]  List all computers in the domain (e.g., Get-NetComputer)
- [ ]  Identify servers, workstations, and their roles (e.g., filter by operatingSystem attribute)
- [ ]  Check for computers with unconstrained delegation (e.g., Get-DomainComputer -Unconstrained)
- [ ]  Enumerate local administrators on key systems if accessible (e.g., net localgroup administrators on a compromised host)

### Share Enumeration

- [ ]  Discover network shares across the domain (e.g., Find-DomainShare in PowerView)
- [ ]  Check share permissions for excessive access (e.g., Get-NetShare)
- [ ]  Search shares for sensitive data (e.g., passwords, config files) using current credentials
- [ ]  Document shares accessible without additional authentication

### Group Policy Object (GPO) Enumeration

- [ ]  List all GPOs in the domain (e.g., Get-NetGPO)
- [ ]  Review GPO settings for security weaknesses (e.g., Get-GPOReport -All -OutputType XML)
- [ ]  Check for GPOs with startup scripts or scheduled tasks that could be exploited
- [ ]  Identify GPOs applying to sensitive objects (e.g., domain controllers, privileged users)

### Trust Enumeration

- [ ]  Identify trusts with other domains or forests (e.g., Get-NetDomainTrust)
- [ ]  Document trust types (e.g., external, forest, bidirectional) and directions
- [ ]  Check if trust relationships can be exploited for lateral movement

## Vulnerability Assessment

### Password Attacks

- [ ]  Perform password spraying against user accounts (e.g., use CrackMapExec with cme smb <target> -u users.txt -p password)
- [ ]  If NTLM hashes are obtained, attempt to crack them (e.g., hashcat -m 1000 hashes.txt wordlist.txt)
- [ ]  Check for accounts with non-expiring passwords (e.g., Get-ADUser -Filter {PasswordNeverExpires -eq $true})
- [ ]  Look for accounts with weak or default passwords based on enumeration data

### Kerberos Attacks

- [ ]  Perform Kerberoasting to obtain Ticket Granting Service (TGS) tickets (e.g., Rubeus.exe kerberoast /outfile:tgs.txt or Invoke-Kerberoast.ps1)
- [ ]  Crack TGS tickets to recover service account passwords (e.g., hashcat -m 13100 tgs.txt wordlist.txt)
- [ ]  Check for accounts with weak encryption (e.g., DES-enabled accounts vulnerable to Kerberoasting)

### Delegation Issues

- [ ]  Identify computers with unconstrained delegation (e.g., Get-DomainComputer -Unconstrained)
- [ ]  Check for misconfigured constrained delegation (e.g., Get-DomainComputer -TrustedToAuth)
- [ ]  Look for users or computers with excessive delegation rights

### Access Control List (ACL) Misconfigurations

- [ ]  Analyze ACLs on AD objects for excessive permissions (e.g., Get-ObjectAcl in PowerView)
- [ ]  Check if low-privileged users can modify sensitive objects (e.g., domain admin group, GPOs)
- [ ]  Identify generic write or full control permissions on critical objects

### Trust Exploitation

- [ ]  If trusts exist, attempt to enumerate the trusted domain (e.g., Get-NetUser -Domain <trusted_domain>)
- [ ]  Check for weak trust credentials or misconfigurations (e.g., SID history abuse)
- [ ]  Attempt to move laterally to trusted domains using obtained credentials

### Other Misconfigurations

- [ ]  Check for exposed credentials in SYSVOL or scripts (e.g., search \\<domain>\SYSVOL for .xml or .bat files)
- [ ]  Verify if SMB signing is disabled (e.g., nmap --script smb-security-mode <target>)
- [ ]  Look for outdated or vulnerable systems in the domain (e.g., Windows Server 2003, unpatched systems)

## Exploitation

### Initial Foothold (If No Access Provided)

- [ ]  Exploit vulnerabilities to gain initial access (e.g., phishing, web app exploits, or exposed services)
- [ ]  Use tools like Metasploit or custom payloads to establish a foothold
- [ ]  Verify access level (e.g., standard user, local admin) after exploitation

### Privilege Escalation

- [ ]  From a standard user, attempt to escalate to local admin (e.g., UAC bypass, Get-System in PowerSploit)
- [ ]  Exploit local service misconfigurations (e.g., unquoted service paths, weak service permissions)
- [ ]  Check for cached credentials on the system (e.g., Mimikatz.exe "sekurlsa::logonpasswords")

### Lateral Movement

- [ ]  Use obtained credentials or hashes to access other systems (e.g., PSExec.exe -u <user> -p <pass> \\<target> cmd)
- [ ]  Leverage WMI for remote execution (e.g., wmic /node:<target> process call create "cmd")
- [ ]  Use RDP with stolen credentials if enabled (e.g., xfreerdp /u:<user> /p:<pass> /v:<target>)

### Domain Escalation

- [ ]  Exploit known vulnerabilities like PrintSpooler or ZeroLogon if applicable (e.g., test with PoC scripts)
- [ ]  Use misconfigurations (e.g., unconstrained delegation) to impersonate privileged users
- [ ]  Attempt DCSync to replicate domain data (e.g., Mimikatz.exe "lsadump::dcsync /domain:<domain> /all")

## Post-Exploitation

### Credential Dumping

- [ ]  Dump local SAM hashes from compromised systems (e.g., Mimikatz.exe "privilege::debug" "sekurlsa::sam")
- [ ]  Extract credentials from LSASS memory (e.g., Mimikatz.exe "sekurlsa::logonpasswords")
- [ ]  Use alternate tools like procdump and Mimikatz offline if live dumping is restricted

### Persistence

- [ ]  Create backdoors or scheduled tasks (e.g., schtasks /create /tn "Backdoor" /tr "cmd.exe" /sc daily)
- [ ]  Add a user to the Domain Admins group if privileges allow (e.g., net group "Domain Admins" <user> /add /domain)
- [ ]  Forge a Golden Ticket for persistent access (e.g., Mimikatz.exe "kerberos::golden /admin:<user> /domain:<domain> /sid:<sid> /krbtgt:<hash>")

### Data Exfiltration

- [ ]  Access sensitive data from shares or databases (e.g., copy files from \\<server>\share)
- [ ]  Exfiltrate data using covert channels if needed (e.g., DNS tunneling, HTTP)
- [ ]  Document accessed resources and their contents

## Reporting

- [ ]  Document all steps taken during the pentest (e.g., commands run, tools used)
- [ ]  Include evidence of findings (e.g., screenshots, command outputs, logs)
- [ ]  Provide detailed remediation recommendations for each vulnerability
- [ ]  Rate the severity of each finding (e.g., low, medium, high, critical)
- [ ]  Summarize the attack paths exploited (e.g., using BloodHound graphs)
- [ ]  Create a final report document linked from this checklist in Obsidian